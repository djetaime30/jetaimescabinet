<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jetaime’s Cabinet – Celestial Christmas</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{--bg:#0b0814;--deep:#12101f;--ink:#1a1728;--text:#e0dbe3;--gold:#c9b08a;--frost:#b8c2d8;--glow:#c9b08a44;}
body{margin:0;font-family:georgia,serif;background:linear-gradient(180deg,var(--bg)0%,var(--deep)100%);color:var(--text);text-align:center;padding:20px 15px;min-height:100vh;overflow-x:hidden;}
h1{font-size:2.7em;margin:0.6em 0 0.3em;color:var(--frost);text-shadow:0 0 20px var(--glow);}
h1 small{font-size:0.48em;display:block;color:var(--gold);}
.collage{max-width:920px;width:100%;margin:30px auto;border:16px solid var(--ink);border-radius:22px;box-shadow:0 0 80px rgba(0,0,0,.95),0 0 50px var(--glow);display:block;}
.words{display:grid;grid-template-columns:repeat(auto-fit,minmax(156px,1fr));gap:18px;margin:50px auto;max-width:860px;}
button{background:var(--ink);color:var(--text);border:2px solid #1e1a2e;padding:18px 12px;font-size:1.28em;cursor:pointer;border-radius:16px;transition:all .38s;box-shadow:0 4px 12px rgba(0,0,0,.6);}
button:hover{background:#1e1a2e;transform:translateY(-4px);}
button.selected{background:var(--gold);color:#0f0c1a;border-color:#a08c6b;font-weight:bold;box-shadow:0 0 32px var(--glow);}
#revealBtn{background:var(--ink);color:var(--frost);border:3px solid var(--gold);padding:24px 60px;font-size:1.7em;margin:40px auto;border-radius:18px;display:inline-block;cursor:pointer;}
#revealBtn:hover{background:var(--gold);color:#0f0c1a;}
#result,#correspondence{margin-top:70px;font-size:1.6em;line-height:1.8;opacity:0;transition:opacity 1.6s;}
#result.show,#correspondence.show{opacity:1;}
.rare{color:var(--gold);font-size:2.1em;text-shadow:0 0 38px var(--gold);}
canvas{position:fixed;top:0;left:0;pointer-events:none;z-index:1;}
.howto,.kofi,.corr{background:rgba(30,26,46,.44);padding:28px;border-radius:18px;margin:70px auto;max-width:720px;border:2px solid var(--frost);font-size:1.22em;line-height:1.8;}
</style>
</head>
<body>

<canvas id="snow"></canvas"></canvas>

<!-- Elegant Golden Siamese Cat -->
<div id="goldenCat" style="position:fixed;bottom:70px;left:-160px;width:140px;height:140px;pointer-events:none;z-index:10;opacity:0;transition:opacity 0.8s ease;transform:scale(0.9);">
  <svg viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <radialGradient id="goldFur" cx="30%" cy="30%">
        <stop offset="0%" stop-color="#f5e1b8"/>
        <stop offset="100%" stop-color="#c9b08a"/>
      </radialGradient>
    </defs>
    <!-- Body -->
    <ellipse cx="70" cy="92" rx="48" ry="30" fill="url(#goldFur)"/>
    <!-- Head -->
    <ellipse cx="70" cy="54" rx="34" ry="38" fill="url(#goldFur)"/>
    <!-- Ears -->
    <path d="M46 28 L60 10 L74 28 Z" fill="#8b6f47"/>
    <path d="M94 28 L80 10 L66 28 Z" fill="#8b6f47"/>
    <!-- Dark points (classic Siamese) -->
    <circle cx="70" cy="54" r="34" fill="#3a2e22" opacity="0.4"/>
    <ellipse cx="70" cy="100" rx="20" ry="12" fill="#3a2e22" opacity="0.5"/>
    <!-- Eyes – bright sapphire -->
    <ellipse cx="58" cy="48" rx="8" ry="14" fill="#6ac8e8"/>
    <ellipse cx="82" cy="48" rx="8" ry="14" fill="#6ac8e8"/>
    <circle cx="60" cy="46" r="3" fill="#000"/>
    <circle cx="84" cy="46" r="3" fill="#000"/>
    <!-- Tail -->
    <path d="M90 90 Q120 60 115 100" stroke="#8b6f47" stroke-width="16" fill="none"/>
    <path d="M90 90 Q120 60 115 100" stroke="#c9b08a" stroke-width="10" fill="none"/>
  </svg>
</div>

<h1>Jetaime’s Cabinet of Possibilities<br><small>Celestial Christmas 2021–2025</small></h1>
<p>Let the collage rest in your eyes for a moment.<br>Then touch every phrase that already feels like home tonight.</p>

<img src="https://files.catbox.moe/smzrhr.jpg" class="collage" alt="Celestial Christmas">

<div class="words" id="wordlist"></div>
<button id="revealBtn">Reveal My Celestial Name</button>

<div id="result"></div>
<div id="correspondence"></div>

<div class="corr" id="corrSection" style="display:none;">
  <strong>Your private correspondence with the Midnight Blue</strong><br><br>
  <span id="corrText"></span><br><br>
  <button onclick="downloadHistory()">Download Cabinet_correspondence.txt</button>
</div>

<div class="howto"><strong>How to share:</strong><br>1. Wait for your name<br>2. Tap “Copy share text”<br>3. Send it into the night</div>
<div class="kofi">The candle still burns because of kind hearts<br>
  <a href="https://ko-fi.com/jetaimes" target="_blank" style="color:var(--gold);">Leave a midnight star for Jetaime</a>
</div>

<script>
// 28 phrases
const words = [
  ["gilded solitude",1],["vaulted silence",1],["solitary beam",1],["cabinet of wonders",1],
  ["bronze astrolabe",2],["black candle smoke",2],["owl in velvet",2],["crypt door",2],
  ["celestial dome",3],["midnight zodiac",3],["gold-leaf stars",3],["astral mirror",3],
  ["ribboned medallion",4],["antique comb",4],["mourning silk",4],["alchemical rose",4],
  ["snowlit altar",5],["hanging star",5],["light from above",5],["sacred descent",5],
  ["tower library",6],["books of night",6],["feathered watcher",6],["quiet throne",6],
  ["held in darkness",7],["gentle gold",7],["earned radiance",7],["still sovereign",7]
];

const archetypes = ["", 
  {name:"The Keeper of the Gilded Solitude", poem:"I locked the world outside the brass-bound door,<br>sat alone with the echo of my name,<br>and found the silence wearing my own crown…"},
  {name:"The Watcher at the Crypt Door", poem:"Seven black candles know my grief by heart…"},
  {name:"The Celestial Navigator", poem:"I drew the winter sky across my skin<br>with gold that still remembers being sun…"},
  {name:"The Guardian of Forbidden Relics", poem:"The comb still holds a stranger’s midnight hair…"},
  {name:"The Beam That Remembers the Sun", poem:"One shaft of light slipped through the dome at dawn…"},
  {name:"The Librarian of the Hidden Tower", poem:"The owl and I have an agreement made of hush…"},
  {name:"The Sovereign of Earned Gold", poem:"I carried sorrow until it learned my weight…"},
  {name:"<span class='rare'>The Dusky Celestial Sovereign</span>", poem:"I am the pause between the bells at midnight…"}
];

let selected = [];

// Snow – never freezes
const canvas = document.getElementById("snowcanvas");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth; canvas.height = innerHeight;
let particles = [];

class Flake {
  constructor(){this.reset();}
  reset(){
    this.x = Math.random() * canvas.width;
    this.y = Math.random() * -100 - 20;
    this.size = Math.random() * 2.6 + 0.9;
    this.speedY = Math.random() * 1.8 + 0.8;
    this.speedX = Math.random() * 0.8 - 0.4;
    this.opacity = Math.random() * 0.6 + 0.4;
    this.gold = Math.random() < 0.08;
  }
  update(){
    this.y += this.speedY; this.x += this.speedX;
    if(this.y > canvas.height + 20) this.reset();
  }
  draw(){
    ctx.globalAlpha = this.opacity;
    ctx.fillStyle = this.gold ? "#c9b08a" : "#e8f1fc";
    ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI*2); ctx.fill();
  ;
  }
}
for(let i=0;i<180;i++) particles.push(new Flake());

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p => {p.update(); p.draw();});
  requestAnimationFrame(animate);
}
animate();

window.addEventListener("resize",()=>{canvas.width=innerWidth;canvas.height=innerHeight;});

// Elegant Golden Cat – 30 seconds
setTimeout(()=>{
  const cat = document.getElementById("goldenCat");
  cat.style.opacity = "1";
  cat.style.transition = "left 9s cubic-bezier(0.2, 0.8, 0.4, 1), opacity 0.8s";
  cat.style.left = "calc(50% - 70px)";

  // golden sparkle burst when she plays
  setTimeout(()=>{
    for(let i=0;i<22;i++){
      particles.push({
        x: innerWidth/2 + Math.random()*120-60,
        y: innerHeight-160,
        size: Math.random()*6+4,
        speedY: -Math.random()*10-5,
        speedX: Math.random()*12-6,
        opacity:1,
        gold:true,
        update:function(){this.y+=this.speedY;this.x+=this.speedX;this.opacity-=0.03;},
        draw:function(){
          ctx.globalAlpha = this.opacity;
          ctx.fillStyle="#c9b08a";
          ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fill();
        }
      });
    }
  },4500);

  // exit majestically
  setTimeout(()=>{cat.style.left="110%";cat.style.opacity="0";},10000);
},30000);

// Game
function init(){
  const list = document.getElementById("wordlist");
  [...words].sort(()=>Math.random()-0.5).forEach(w=>{
    const b=document.createElement("button");
    b.textContent=w[0];
    b.onclick=()=>{b.classList.toggle("selected");
      selected.includes(w[0]) ? selected=selected.filter(x=>x!==w[0]) : selected.push(w[0]);
    };
    list.appendChild(b);
  });
}

function calculate(){
  if(selected.length===0){alert("Choose at least one phrase that calls to you.");return;}
  const counts={};
  selected.forEach(w=> {const g=words.find(a=>a[0]===w)[1]; counts[g]=(counts[g]||0)+1;});
  const uniq = new Set(selected.map(w=>words.find(a=>a[0]===w)[1])).size;
  const idx = uniq>=6 ? 8 : Object.keys(counts).reduce((a,b)=>counts[a]>counts[b]?a:b);
  const arch = archetypes[idx];
  document.getElementById("result").innerHTML = `
    <h2>${arch.name}</h2>
    <p style="font-size:1.1em;line-height:2;">${arch.poem}</p>
    <p style="margin-top:60px;"><button onclick="copyShare()" style="padding:15px 40px;background:var(--gold);color:#0f0c1a;border:none;border-radius:16px;font-size:1.3em;">Copy share text</button></p>
  `;
  document.getElementById("result").classList.add("show");
  document.getElementById("result").scrollIntoView({behavior:"smooth"});

  // SAVE TO LOCALSTORAGE
  const entry = {date:new Date().toISOString().slice(0,10), archetype:arch.name.replace(/<[^>]*>/g,'').trim(), words:selected.slice()};
  let hist = JSON.parse(localStorage.getItem("cabinetHistory")|| "[]");
  hist.push(entry); localStorage.setItem("cabinetHistory", JSON.stringify(hist));
  updateCorrespondence();

  selected=[]; document.querySelectorAll(".selected").forEach(b=>b.classList.remove("selected"));
}

function updateCorrespondence(){
  const h = JSON.parse(localStorage.getItem("cabinetHistory")|| "[]");
  if(h.length===0) return;
  document.getElementById("corrSection").style.display="block";
  let t = `The Midnight Blue has spoken to you ${h.length} time${h.length>1?'s':''} across the years.\n\n`;
  h.forEach(e=>t+=`${e.date} – ${e.archetype}\n`);
  document.getElementById("corrText").textContent = t;
  document.getElementById("correspondence").innerHTML = `<p><em>${t.replace(/\n/g,"<br>")}</em></p>`;
  document.getElementById("correspondence").classList.add("show");
}

function downloadHistory(){
  const h=JSON.parse(localStorage.getItem("cabinetHistory")|| "[]");
  let txt="Jetaime’s Cabinet – Private Correspondence\n\n";
  h.forEach(e=>txt+=`${e.date} – ${e.archetype}\nWords: ${e.words.join(", ")}\n\n`);
  const blob=new Blob([txt],{type:"text/plain"});
  const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="Cabinet_correspondence.txt";a.click();
}

function copyShare(){
  const name = document.querySelector("#result h2")?.innerText || "my celestial name";
  navigator.clipboard.writeText(`I just became "${name}" in Jetaime’s Celestial Christmas Cabinet ♡\n${location.href}`);
  alert("Copied!");
}

init();
updateCorrespondence();
document.getElementById("revealBtn").onclick = calculate;
</script>
</body>
</html>